# Migration `20201118145921-init`

This migration has been generated by Baptiste Gislot at 11/18/2020, 3:59:21 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
    "id" TEXT NOT NULL,
    "firstname" TEXT NOT NULL,
    "lastname" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "password" TEXT NOT NULL,
    "phone_number" TEXT,
    "picture" TEXT,
    "roleId" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Role" (
    "id" TEXT NOT NULL,
    "role" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Language" (
    "id" TEXT NOT NULL,
    "language" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "User_Language" (
    "id" TEXT NOT NULL,
    "userId" TEXT NOT NULL,
    "languageId" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Message" (
    "id" TEXT NOT NULL,
    "sender_id" TEXT NOT NULL,
    "recipient_id" TEXT NOT NULL,
    "content" TEXT NOT NULL,
    "date" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Schedule" (
    "id" TEXT NOT NULL,
    "title" TEXT NOT NULL,
    "start_date" TIMESTAMP(3) NOT NULL,
    "end_date" TIMESTAMP(3) NOT NULL,
    "is_done" BOOLEAN NOT NULL DEFAULT false,
    "color" TEXT NOT NULL,
    "user_id" TEXT NOT NULL,
    "interpreter_id" TEXT NOT NULL,
    "noteId" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Note" (
    "id" TEXT NOT NULL,
    "note" INTEGER NOT NULL,
    "comment" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "User.email_unique" ON "User"("email")

ALTER TABLE "User" ADD FOREIGN KEY("roleId")REFERENCES "Role"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "User_Language" ADD FOREIGN KEY("userId")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "User_Language" ADD FOREIGN KEY("languageId")REFERENCES "Language"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Message" ADD FOREIGN KEY("sender_id")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Message" ADD FOREIGN KEY("recipient_id")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Schedule" ADD FOREIGN KEY("noteId")REFERENCES "Note"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Schedule" ADD FOREIGN KEY("user_id")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Schedule" ADD FOREIGN KEY("interpreter_id")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201118145921-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,73 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id String @id @default(uuid())
+  firstname String
+  lastname String
+  email String @unique
+  password String
+  role Role
+  languages User_Language[]
+  phone_number String?
+  picture String?
+  messages_as_sender Message[] @relation("messages_as_sender")
+  messages_as_recipient Message[] @relation("messages_as_recipient")
+  schedule_as_user Schedule[] @relation("schedule_as_user")
+  schedule_as_interpreter Schedule[] @relation("schedule_as_interpreter")
+}
+
+model Role {
+  id String @id @default(uuid())
+  role String
+}
+
+model Language {
+  id String @id @default(uuid())
+  language String
+}
+
+model User_Language {
+  id String @id @default(uuid())
+  user_id User
+  language_id Language
+}
+
+model Message {
+  id String @id @default(uuid())
+  sender User @relation("messages_as_sender", fields: [sender_id], references: [id])
+  sender_id String 
+  recipient User @relation("messages_as_recipient", fields: [recipient_id], references: [id])
+  recipient_id String
+  content String
+  date DateTime
+}
+
+model Schedule {
+  id String @id @default(uuid())
+  title String
+  start_date DateTime
+  end_date DateTime
+  is_done Boolean @default(false)
+  color String
+  note Note
+  user User @relation("schedule_as_user", fields: [user_id], references: [id])
+  user_id String
+  interpreter User @relation("schedule_as_interpreter", fields: [interpreter_id], references: [id])
+  interpreter_id String
+}
+
+model Note {
+  id String @id @default(uuid())
+  note Int
+  comment String
+}
```


